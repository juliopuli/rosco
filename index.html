<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <title>Pasapalabra v3.1.0</title>
    <script src="https://unpkg.com/peerjs@1.5.2/dist/peerjs.min.js"></script>
    <style>
        :root { --fondo: #050a1f; --panel: #111b3d; --oro: #ffcc00; --verde: #2ecc71; --rojo: #dc3545; --azul-letra: #0044ff; }
        body { background: var(--fondo); color: white; font-family: 'Segoe UI', sans-serif; margin: 0; overflow: hidden; display: flex; align-items: center; justify-content: center; min-height: 100vh; }
        .oculto { display: none !important; }

        /* VERSIÓN ABAJO A LA IZQUIERDA */
        .version-tag { position: fixed; bottom: 10px; left: 10px; opacity: 0.6; font-size: 0.9rem; font-weight: bold; color: #aaa; z-index: 200; }

        /* PANEL SUPERADMIN MEJORADO */
        #panel-admin { display: none; position: fixed; top: 20px; right: 20px; background: rgba(0,0,0,0.9); border: 2px solid var(--oro); padding: 20px; border-radius: 10px; z-index: 1000; min-width: 200px; text-align: center; box-shadow: 0 0 20px rgba(255, 204, 0, 0.2); }
        #admin-titulo { color: var(--oro); font-weight: bold; font-size: 1.3rem; margin: 0; text-transform: uppercase; }
        #admin-rol { color: red; font-size: 0.7rem; font-weight: bold; letter-spacing: 3px; margin-bottom: 10px; border-bottom: 1px solid #555; padding-bottom: 5px; }
        
        .contador-box { background: #333; padding: 10px; border-radius: 5px; margin: 10px 0; }
        .num-grande { font-size: 2rem; color: var(--verde); font-weight: bold; }
        
        #admin-lista { text-align: left; font-size: 0.9rem; color: #ddd; margin-top: 10px; }
        .jugador-item { padding: 5px; border-bottom: 1px solid #444; }

        /* Estilo Pantallas */
        .pantalla { text-align: center; background: var(--panel); padding: 40px; border-radius: 20px; border: 1px solid #2a3a6d; width: 420px; box-shadow: 0 10px 40px rgba(0,0,0,0.5); z-index: 10; }
        h1, h2 { color: var(--oro); margin-top: 0; }
        
        input { width: 85%; padding: 12px; margin: 10px 0; border-radius: 8px; border: none; font-size: 1rem; text-align: center; outline: none; }
        
        .btn { width: 100%; padding: 15px; margin: 10px 0; border-radius: 50px; border: none; font-weight: bold; cursor: pointer; text-transform: uppercase; font-size: 1rem; transition: 0.2s; }
        .btn:hover { transform: scale(1.02); }
        .btn-green { background: var(--verde); color: white; }
        .btn-blue { background: #3498db; color: white; }
        .btn-purple { background: #9b59b6; color: white; }
        .btn-admin { background: #333; color: #aaa; border: 1px solid #555; font-size: 0.8rem; padding: 10px; width: 30%; }

        /* JUEGO */
        #tablero-juego { display: none; width: 100vw; height: 100vh; position: relative; }
        
        .jugador-main { position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%); width: 550px; height: 550px; border-radius: 50%; border: 3px solid var(--oro); display: flex; flex-direction: column; align-items: center; justify-content: center; background: rgba(17, 27, 61, 0.95); }
        .jugador-rival { position: absolute; top: 20px; right: 20px; width: 180px; height: 180px; border-radius: 50%; border: 2px solid #555; transform: scale(0.8); opacity: 0.8; display: flex; flex-direction: column; align-items: center; justify-content: center; background: var(--panel); }

        .rosco-container { position: relative; width: 100%; height: 100%; }
        
        .letra { position: absolute; width: 38px; height: 38px; background: var(--azul-letra); border-radius: 50%; display: flex; align-items: center; justify-content: center; font-weight: bold; border: 2px solid white; font-size: 18px; z-index: 10; transition: transform 0.3s; }
        
        .jugador-rival .letra { width: 12px; height: 12px; font-size: 0; border: 1px solid #ccc; }

        .bien { background: var(--verde) !important; border-color: white; }
        .mal { background: var(--rojo) !important; border-color: white; }
        .actual { background: var(--oro) !important; color: black; box-shadow: 0 0 20px var(--oro); transform: scale(1.3); z-index: 20; }

        .centro-mando { position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%); text-align: center; width: 70%; }
        .jugador-rival .centro-mando { display: none; }

        .pregunta { font-size: 1.2rem; min-height: 60px; margin-bottom: 10px; font-weight: bold; text-shadow: 1px 1px 2px black; }
        .btn-juego { padding: 10px 20px; border: none; border-radius: 5px; cursor: pointer; font-weight: bold; margin: 5px; }

    </style>
</head>
<body>

    <div class="version-tag">v3.1.0</div>

    <div id="panel-admin">
        <p id="admin-titulo">PABLO PULI</p>
        <p id="admin-rol">SUPERADMIN</p>
        
        <div class="contador-box">
            <span style="font-size:0.8rem; color:#aaa;">JUGADORES EN SALA</span><br>
            <span id="contador-jugadores" class="num-grande">1</span>
        </div>

        <div id="admin-lista">
            </div>
    </div>

    <div id="pantalla-nombre" class="pantalla">
        <h1>PASAPALABRA</h1>
        <p>Introduce tu nombre</p>
        <input type="text" id="input-nombre" placeholder="Nombre de usuario">
        <button class="btn btn-green" onclick="irAModos()">CONTINUAR</button>
    </div>

    <div id="pantalla-modos" class="pantalla oculto">
        <h2 id="saludo-titulo">HOLA</h2>
        <p>Selecciona modo de juego:</p>
        <button class="btn btn-purple" onclick="modoSolo()">JUGAR SOLO (LOCAL)</button>
        <button class="btn btn-blue" onclick="irAOnline()">JUGAR ONLINE (2 JUGADORES)</button>
        
        <hr style="border-color:#333; margin: 20px 0;">
        <p style="font-size:0.8rem; margin:5px;">¿Tienes un código? Actívalo aquí:</p>
        <input type="password" id="input-admin" placeholder="Código Admin" style="width: 60%; font-size:0.8rem; padding:8px;">
        <button class="btn btn-admin" onclick="verificarAdmin()">OK</button>
    </div>

    <div id="pantalla-online-opciones" class="pantalla oculto">
        <h2>ONLINE</h2>
        <button class="btn btn-orange" onclick="pantallaGenerar()">GENERAR CÓDIGO (HOST)</button>
        <button class="btn btn-green" onclick="pantallaUnirse()">UNIRSE CON CÓDIGO</button>
        <br><br>
        <button class="btn" style="background:#555; color:white" onclick="volverAModos()">ATRÁS</button>
    </div>

    <div id="pantalla-host" class="pantalla oculto">
        <h3>CÓDIGO DE SALA:</h3>
        <h1 id="codigo-mostrado" style="font-size: 3rem; letter-spacing: 5px; background: rgba(0,0,0,0.3); padding: 10px;">...</h1>
        <p id="estado-host" style="color: yellow;">Esperando conexión...</p>
    </div>

    <div id="pantalla-guest" class="pantalla oculto">
        <h3>INTRODUCE CÓDIGO:</h3>
        <input type="text" id="input-codigo" placeholder="Ej: 123456" maxlength="6">
        <button class="btn btn-green" onclick="conectarHost()">ENTRAR</button>
        <p id="estado-guest" style="color: yellow;"></p>
        <button class="btn" style="background:#555; color:white" onclick="volverAOnline()">ATRÁS</button>
    </div>

    <div id="tablero-juego">
        <div id="jugador-yo" class="jugador-main">
            <div id="rosco-yo" class="rosco-container"></div>
            <div class="centro-mando">
                <h2 id="mi-nick" style="margin:0; color:var(--oro)">YO</h2>
                <div id="pregunta-texto" class="pregunta">Cargando...</div>
                <input type="text" id="respuesta-input" placeholder="Respuesta..." autocomplete="off">
                <br>
                <button class="btn-juego" style="background:var(--verde); color:white" onclick="enviarRespuesta()">ENVIAR</button>
                <button class="btn-juego" style="background:var(--oro); color:black" onclick="pasarPalabra()">PASAPALABRA</button>
            </div>
        </div>
        <div id="jugador-rival" class="jugador-rival oculto">
            <h3 id="rival-nick" style="color:white; margin-top: -30px; position:absolute;">RIVAL</h3>
            <div id="rosco-rival" class="rosco-container"></div>
        </div>
    </div>

<script>
    /* BANCO DE PREGUNTAS (25 EXACTAS) */
    const banco = [
        {l:"A", p1:"Relativo a las abejas", r1:"apicola", p2:"Herramienta para apretar tuercas", r2:"alicates"},
        {l:"B", p1:"Mide la dirección del viento", r1:"veleta", p2:"Barco pequeño de madera", r2:"bote"},
        {l:"C", p1:"Vehículo de carga", r1:"camion", p2:"Lugar donde duermes", r2:"cama"},
        {l:"D", p1:"Animal marino inteligente", r1:"delfin", p2:"Día de la semana", r2:"domingo"},
        {l:"E", p1:"Cría de elefantes", r1:"elefanteria", p2:"Animal con púas", r2:"erizo"},
        {l:"F", p1:"Luz guía barcos", r1:"faro", p2:"Flor blanca olorosa", r2:"flor"},
        {l:"G", p1:"Ave de corral", r1:"gallina", p2:"Animal que maúlla", r2:"gato"},
        {l:"H", p1:"Agua sólida", r1:"hielo", p2:"Parte del cuerpo que une cabeza y tronco", r2:"hombro"},
        {l:"I", p1:"Tierra en el mar", r1:"isla", p2:"Casa de hielo esquimal", r2:"iglu"},
        {l:"J", p1:"Cuello largo", r1:"jirafa", p2:"Juguete que sube y baja", r2:"juguete"},
        {l:"L", p1:"Líquido blanco", r1:"leche", p2:"Satélite de la Tierra", r2:"luna"},
        {l:"M", p1:"Fruta roja/verde", r1:"manzana", p2:"Día después del lunes", r2:"martes"},
        {l:"N", p1:"Fruta cítrica", r1:"naranja", p2:"Opuesto de blanco", r2:"negro"},
        {l:"Ñ", p1:"Niño pequeño", r1:"niño", p2:"Ave parecida al avestruz", r2:"ñandu"},
        {l:"O", p1:"Da lana", r1:"oveja", p2:"Órgano para escuchar", r2:"oido"},
        {l:"P", p1:"Teclas blancas/negras", r1:"piano", p2:"Animal que ladra", r2:"perro"},
        {l:"Q", p1:"Leche cuajada", r1:"queso", p2:"Número 15", r2:"quince"},
        {l:"R", p1:"Pequeño roedor", r1:"raton", p2:"Color de la sangre", r2:"rojo"},
        {l:"S", p1:"Astro rey", r1:"sol", p2:"Lugar para sentarse", r2:"silla"},
        {l:"T", p1:"Hablar a distancia", r1:"telefono", p2:"Animal rayado", r2:"tigre"},
        {l:"U", p1:"Fruta del vino", r1:"uva", p2:"Número 1", r2:"uno"},
        {l:"V", p1:"Vive al lado", r1:"vecino", p2:"Color de la hierba", r2:"verde"},
        {l:"X", p1:"Instrumento musical", r1:"xilofono", p2:"Prueba médica", r2:"rayos x"},
        {l:"Y", p1:"Barco de lujo", r1:"yate", p2:"Parte del huevo", r2:"yema"},
        {l:"Z", p1:"Calzado", r1:"zapato", p2:"Animal con rayas blancas y negras", r2:"cebra"}
    ];

    /* VARIABLES DE ESTADO */
    let nombre = "";
    let modo = ""; 
    let peer = null; 
    let conn = null;
    let turnoActual = 1; 
    let miRol = 1; 
    let isAdmin = false;

    let estado = {
        j1: { pos: 0, aciertos: new Array(25).fill(0), nombre: "" },
        j2: { pos: 0, aciertos: new Array(25).fill(0), nombre: "" }
    };

    /* FUNCIONES DE NAVEGACIÓN */
    function ocultarTodo() {
        document.querySelectorAll('.pantalla').forEach(p => p.classList.add('oculto'));
        document.getElementById('tablero-juego').style.display = 'none';
    }

    function irAModos() {
        nombre = document.getElementById('input-nombre').value.trim();
        if(!nombre) return alert("Pon un nombre");
        estado.j1.nombre = nombre;
        document.getElementById('saludo-titulo').innerText = "HOLA, " + nombre.toUpperCase();
        ocultarTodo();
        document.getElementById('pantalla-modos').classList.remove('oculto');
        actualizarAdmin();
    }

    function volverAModos() { ocultarTodo(); document.getElementById('pantalla-modos').classList.remove('oculto'); }
    function irAOnline() { ocultarTodo(); document.getElementById('pantalla-online-opciones').classList.remove('oculto'); }
    function volverAOnline() { ocultarTodo(); document.getElementById('pantalla-online-opciones').classList.remove('oculto'); }

    /* LÓGICA DE ADMIN */
    function verificarAdmin() {
        const cod = document.getElementById('input-admin').value;
        if(cod === "Pablo23sek") {
            isAdmin = true;
            document.getElementById('panel-admin').style.display = 'block';
            alert("¡Modo Superadmin Activado!");
            actualizarAdmin();
        } else {
            alert("Código incorrecto");
        }
    }

    function actualizarAdmin() {
        if(!isAdmin) return;
        
        let conteo = 0;
        let listaHTML = "";

        // Jugador 1 (Host o Solo)
        if(estado.j1.nombre) {
            conteo++;
            listaHTML += `<div class="jugador-item">1. ${estado.j1.nombre} (HOST)</div>`;
        }

        // Jugador 2 (Guest)
        if(modo === 'online' && estado.j2.nombre) {
            conteo++;
            listaHTML += `<div class="jugador-item">2. ${estado.j2.nombre} (GUEST)</div>`;
        } else if (modo === 'online') {
            listaHTML += `<div class="jugador-item" style="color:#777">2. Esperando...</div>`;
        }

        document.getElementById('contador-jugadores').innerText = conteo;
        document.getElementById('admin-lista').innerHTML = listaHTML;
    }

    /* LÓGICA DE JUEGO */
    function modoSolo() {
        modo = 'solo'; miRol = 1; turnoActual = 1;
        document.getElementById('jugador-rival').classList.add('oculto');
        iniciarJuegoUI();
    }

    function pantallaGenerar() {
        modo = 'online'; miRol = 1; estado.j1.nombre = nombre;
        ocultarTodo(); document.getElementById('pantalla-host').classList.remove('oculto');
        const idSala = Math.floor(100000 + Math.random() * 900000);
        document.getElementById('codigo-mostrado').innerText = idSala;
        
        peer = new Peer(idSala.toString());
        peer.on('connection', (c) => {
            conn = c;
            document.getElementById('estado-host').innerText = "Conectando...";
            setupConexion();
        });
        actualizarAdmin();
    }

    function pantallaUnirse() {
        modo = 'online'; miRol = 2; estado.j2.nombre = nombre;
        ocultarTodo(); document.getElementById('pantalla-guest').classList.remove('oculto');
        actualizarAdmin();
    }

    function conectarHost() {
        const codigo = document.getElementById('input-codigo').value;
        if(codigo.length !== 6) return alert("Código de 6 cifras");
        document.getElementById('estado-guest').innerText = "Buscando...";
        peer = new Peer();
        peer.on('open', () => {
            conn = peer.connect(codigo);
            conn.on('open', () => {
                setupConexion();
                conn.send({ tipo: 'SALUDO', nombre: nombre });
            });
            peer.on('error', () => alert("Error de conexión"));
        });
    }

    function setupConexion() {
        conn.on('data', (data) => {
            if(data.tipo === 'SALUDO' && miRol === 1) {
                estado.j2.nombre = data.nombre;
                actualizarAdmin();
                enviarEstado('START');
                iniciarJuegoUI();
            }
            if(data.tipo === 'START') { estado = data.estado; iniciarJuegoUI(); }
            if(data.tipo === 'UPDATE') { estado = data.estado; turnoActual = data.turno; actualizarTablero(); }
        });
    }

    function enviarEstado(tipo) {
        if(conn) conn.send({ tipo: tipo, estado: estado, turno: turnoActual });
    }

    function iniciarJuegoUI() {
        ocultarTodo();
        document.getElementById('tablero-juego').style.display = 'block';
        document.getElementById('mi-nick').innerText = (miRol === 1) ? estado.j1.nombre : estado.j2.nombre;
        document.getElementById('rival-nick').innerText = (miRol === 1) ? estado.j2.nombre : estado.j1.nombre;
        
        if(modo === 'online') document.getElementById('jugador-rival').classList.remove('oculto');
        
        crearRoscoHTML('rosco-yo', 260);
        crearRoscoHTML('rosco-rival', 80);
        actualizarTablero();
        actualizarAdmin();
    }

    function crearRoscoHTML(id, radio) {
        const cont = document.getElementById(id);
        cont.innerHTML = "";
        banco.forEach((obj, i) => {
            let div = document.createElement('div');
            div.innerText = obj.l;
            div.className = 'letra';
            div.id = `${id}-${i}`;
            
            let ang = (i * 360 / 25) - 90;
            let rad = ang * (Math.PI / 180);
            let x = Math.cos(rad) * radio;
            let y = Math.sin(rad) * radio;
            
            div.style.left = `calc(50% + ${x}px - 19px)`; 
            div.style.top = `calc(50% + ${y}px - 19px)`;
            cont.appendChild(div);
        });
    }

    function actualizarTablero() {
        let misDatos = (miRol === 1) ? estado.j1 : estado.j2;
        let rivalDatos = (miRol === 1) ? estado.j2 : estado.j1;

        pintarRosco('rosco-yo', misDatos);
        pintarRosco('rosco-rival', rivalDatos);

        if(turnoActual === miRol) {
            let obj = banco[misDatos.pos];
            let preguntaTexto = (miRol === 1) ? obj.p1 : obj.p2; 
            
            document.getElementById('pregunta-texto').innerText = `CON LA ${obj.l}: ${preguntaTexto}`;
            document.getElementById('respuesta-input').disabled = false;
            document.getElementById('respuesta-input').focus();
            document.getElementById('jugador-yo').style.opacity = "1";
            document.getElementById('jugador-yo').style.borderColor = "var(--oro)";
            if(modo==='online') document.getElementById('jugador-rival').style.opacity = "0.5";
        } else {
            document.getElementById('pregunta-texto').innerText = "ESPERANDO AL RIVAL...";
            document.getElementById('respuesta-input').disabled = true;
            document.getElementById('jugador-yo').style.opacity = "0.7";
            document.getElementById('jugador-yo').style.borderColor = "#555";
            if(modo==='online') {
                document.getElementById('jugador-rival').style.opacity = "1";
                document.getElementById('jugador-rival').style.borderColor = "var(--oro)";
            }
        }
    }

    function pintarRosco(prefijo, datos) {
        for(let i=0; i<25; i++) {
            let el = document.getElementById(`${prefijo}-${i}`);
            el.className = 'letra';
            if(datos.aciertos[i] === 1) el.classList.add('bien');
            if(datos.aciertos[i] === 2) el.classList.add('mal');
            if(i === datos.pos) el.classList.add('actual');
        }
    }

    function enviarRespuesta() {
        if(turnoActual !== miRol) return;
        let misDatos = (miRol === 1) ? estado.j1 : estado.j2;
        let input = document.getElementById('respuesta-input');
        let respUser = input.value.toLowerCase().trim()
                                .normalize("NFD").replace(/[\u0300-\u036f]/g, ""); 
        
        let obj = banco[misDatos.pos];
        let respCorrecta = (miRol === 1) ? obj.r1 : obj.r2; 

        if(respUser === respCorrecta) {
            misDatos.aciertos[misDatos.pos] = 1;
        } else {
            misDatos.aciertos[misDatos.pos] = 2;
            if(modo !== 'solo') turnoActual = (turnoActual === 1) ? 2 : 1;
        }
        misDatos.pos = (misDatos.pos + 1) % 25;
        input.value = "";
        
        if(modo === 'online') enviarEstado('UPDATE');
        actualizarTablero();
    }

    function pasarPalabra() {
        if(turnoActual !== miRol) return;
        let misDatos = (miRol === 1) ? estado.j1 : estado.j2;
        misDatos.pos = (misDatos.pos + 1) % 25;
        if(modo !== 'solo') turnoActual = (turnoActual === 1) ? 2 : 1;
        
        document.getElementById('respuesta-input').value = "";
        if(modo === 'online') enviarEstado('UPDATE');
        actualizarTablero();
    }

    document.getElementById('respuesta-input').addEventListener('keypress', (e) => {
        if(e.key === 'Enter') enviarRespuesta();
    });

</script>
</body>
</html><!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <title>Pasapalabra v3.1.0</title>
    <script src="https://unpkg.com/peerjs@1.5.2/dist/peerjs.min.js"></script>
    <style>
        :root { --fondo: #050a1f; --panel: #111b3d; --oro: #ffcc00; --verde: #2ecc71; --rojo: #dc3545; --azul-letra: #0044ff; }
        body { background: var(--fondo); color: white; font-family: 'Segoe UI', sans-serif; margin: 0; overflow: hidden; display: flex; align-items: center; justify-content: center; min-height: 100vh; }
        .oculto { display: none !important; }

        /* VERSIÓN ABAJO A LA IZQUIERDA */
        .version-tag { position: fixed; bottom: 10px; left: 10px; opacity: 0.6; font-size: 0.9rem; font-weight: bold; color: #aaa; z-index: 200; }

        /* PANEL SUPERADMIN MEJORADO */
        #panel-admin { display: none; position: fixed; top: 20px; right: 20px; background: rgba(0,0,0,0.9); border: 2px solid var(--oro); padding: 20px; border-radius: 10px; z-index: 1000; min-width: 200px; text-align: center; box-shadow: 0 0 20px rgba(255, 204, 0, 0.2); }
        #admin-titulo { color: var(--oro); font-weight: bold; font-size: 1.3rem; margin: 0; text-transform: uppercase; }
        #admin-rol { color: red; font-size: 0.7rem; font-weight: bold; letter-spacing: 3px; margin-bottom: 10px; border-bottom: 1px solid #555; padding-bottom: 5px; }
        
        .contador-box { background: #333; padding: 10px; border-radius: 5px; margin: 10px 0; }
        .num-grande { font-size: 2rem; color: var(--verde); font-weight: bold; }
        
        #admin-lista { text-align: left; font-size: 0.9rem; color: #ddd; margin-top: 10px; }
        .jugador-item { padding: 5px; border-bottom: 1px solid #444; }

        /* Estilo Pantallas */
        .pantalla { text-align: center; background: var(--panel); padding: 40px; border-radius: 20px; border: 1px solid #2a3a6d; width: 420px; box-shadow: 0 10px 40px rgba(0,0,0,0.5); z-index: 10; }
        h1, h2 { color: var(--oro); margin-top: 0; }
        
        input { width: 85%; padding: 12px; margin: 10px 0; border-radius: 8px; border: none; font-size: 1rem; text-align: center; outline: none; }
        
        .btn { width: 100%; padding: 15px; margin: 10px 0; border-radius: 50px; border: none; font-weight: bold; cursor: pointer; text-transform: uppercase; font-size: 1rem; transition: 0.2s; }
        .btn:hover { transform: scale(1.02); }
        .btn-green { background: var(--verde); color: white; }
        .btn-blue { background: #3498db; color: white; }
        .btn-purple { background: #9b59b6; color: white; }
        .btn-admin { background: #333; color: #aaa; border: 1px solid #555; font-size: 0.8rem; padding: 10px; width: 30%; }

        /* JUEGO */
        #tablero-juego { display: none; width: 100vw; height: 100vh; position: relative; }
        
        .jugador-main { position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%); width: 550px; height: 550px; border-radius: 50%; border: 3px solid var(--oro); display: flex; flex-direction: column; align-items: center; justify-content: center; background: rgba(17, 27, 61, 0.95); }
        .jugador-rival { position: absolute; top: 20px; right: 20px; width: 180px; height: 180px; border-radius: 50%; border: 2px solid #555; transform: scale(0.8); opacity: 0.8; display: flex; flex-direction: column; align-items: center; justify-content: center; background: var(--panel); }

        .rosco-container { position: relative; width: 100%; height: 100%; }
        
        .letra { position: absolute; width: 38px; height: 38px; background: var(--azul-letra); border-radius: 50%; display: flex; align-items: center; justify-content: center; font-weight: bold; border: 2px solid white; font-size: 18px; z-index: 10; transition: transform 0.3s; }
        
        .jugador-rival .letra { width: 12px; height: 12px; font-size: 0; border: 1px solid #ccc; }

        .bien { background: var(--verde) !important; border-color: white; }
        .mal { background: var(--rojo) !important; border-color: white; }
        .actual { background: var(--oro) !important; color: black; box-shadow: 0 0 20px var(--oro); transform: scale(1.3); z-index: 20; }

        .centro-mando { position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%); text-align: center; width: 70%; }
        .jugador-rival .centro-mando { display: none; }

        .pregunta { font-size: 1.2rem; min-height: 60px; margin-bottom: 10px; font-weight: bold; text-shadow: 1px 1px 2px black; }
        .btn-juego { padding: 10px 20px; border: none; border-radius: 5px; cursor: pointer; font-weight: bold; margin: 5px; }

    </style>
</head>
<body>

    <div class="version-tag">v3.1.0</div>

    <div id="panel-admin">
        <p id="admin-titulo">PABLO PULI</p>
        <p id="admin-rol">SUPERADMIN</p>
        
        <div class="contador-box">
            <span style="font-size:0.8rem; color:#aaa;">JUGADORES EN SALA</span><br>
            <span id="contador-jugadores" class="num-grande">1</span>
        </div>

        <div id="admin-lista">
            </div>
    </div>

    <div id="pantalla-nombre" class="pantalla">
        <h1>PASAPALABRA</h1>
        <p>Introduce tu nombre</p>
        <input type="text" id="input-nombre" placeholder="Nombre de usuario">
        <button class="btn btn-green" onclick="irAModos()">CONTINUAR</button>
    </div>

    <div id="pantalla-modos" class="pantalla oculto">
        <h2 id="saludo-titulo">HOLA</h2>
        <p>Selecciona modo de juego:</p>
        <button class="btn btn-purple" onclick="modoSolo()">JUGAR SOLO (LOCAL)</button>
        <button class="btn btn-blue" onclick="irAOnline()">JUGAR ONLINE (2 JUGADORES)</button>
        
        <hr style="border-color:#333; margin: 20px 0;">
        <p style="font-size:0.8rem; margin:5px;">¿Tienes un código? Actívalo aquí:</p>
        <input type="password" id="input-admin" placeholder="Código Admin" style="width: 60%; font-size:0.8rem; padding:8px;">
        <button class="btn btn-admin" onclick="verificarAdmin()">OK</button>
    </div>

    <div id="pantalla-online-opciones" class="pantalla oculto">
        <h2>ONLINE</h2>
        <button class="btn btn-orange" onclick="pantallaGenerar()">GENERAR CÓDIGO (HOST)</button>
        <button class="btn btn-green" onclick="pantallaUnirse()">UNIRSE CON CÓDIGO</button>
        <br><br>
        <button class="btn" style="background:#555; color:white" onclick="volverAModos()">ATRÁS</button>
    </div>

    <div id="pantalla-host" class="pantalla oculto">
        <h3>CÓDIGO DE SALA:</h3>
        <h1 id="codigo-mostrado" style="font-size: 3rem; letter-spacing: 5px; background: rgba(0,0,0,0.3); padding: 10px;">...</h1>
        <p id="estado-host" style="color: yellow;">Esperando conexión...</p>
    </div>

    <div id="pantalla-guest" class="pantalla oculto">
        <h3>INTRODUCE CÓDIGO:</h3>
        <input type="text" id="input-codigo" placeholder="Ej: 123456" maxlength="6">
        <button class="btn btn-green" onclick="conectarHost()">ENTRAR</button>
        <p id="estado-guest" style="color: yellow;"></p>
        <button class="btn" style="background:#555; color:white" onclick="volverAOnline()">ATRÁS</button>
    </div>

    <div id="tablero-juego">
        <div id="jugador-yo" class="jugador-main">
            <div id="rosco-yo" class="rosco-container"></div>
            <div class="centro-mando">
                <h2 id="mi-nick" style="margin:0; color:var(--oro)">YO</h2>
                <div id="pregunta-texto" class="pregunta">Cargando...</div>
                <input type="text" id="respuesta-input" placeholder="Respuesta..." autocomplete="off">
                <br>
                <button class="btn-juego" style="background:var(--verde); color:white" onclick="enviarRespuesta()">ENVIAR</button>
                <button class="btn-juego" style="background:var(--oro); color:black" onclick="pasarPalabra()">PASAPALABRA</button>
            </div>
        </div>
        <div id="jugador-rival" class="jugador-rival oculto">
            <h3 id="rival-nick" style="color:white; margin-top: -30px; position:absolute;">RIVAL</h3>
            <div id="rosco-rival" class="rosco-container"></div>
        </div>
    </div>

<script>
    /* BANCO DE PREGUNTAS (25 EXACTAS) */
    const banco = [
        {l:"A", p1:"Relativo a las abejas", r1:"apicola", p2:"Herramienta para apretar tuercas", r2:"alicates"},
        {l:"B", p1:"Mide la dirección del viento", r1:"veleta", p2:"Barco pequeño de madera", r2:"bote"},
        {l:"C", p1:"Vehículo de carga", r1:"camion", p2:"Lugar donde duermes", r2:"cama"},
        {l:"D", p1:"Animal marino inteligente", r1:"delfin", p2:"Día de la semana", r2:"domingo"},
        {l:"E", p1:"Cría de elefantes", r1:"elefanteria", p2:"Animal con púas", r2:"erizo"},
        {l:"F", p1:"Luz guía barcos", r1:"faro", p2:"Flor blanca olorosa", r2:"flor"},
        {l:"G", p1:"Ave de corral", r1:"gallina", p2:"Animal que maúlla", r2:"gato"},
        {l:"H", p1:"Agua sólida", r1:"hielo", p2:"Parte del cuerpo que une cabeza y tronco", r2:"hombro"},
        {l:"I", p1:"Tierra en el mar", r1:"isla", p2:"Casa de hielo esquimal", r2:"iglu"},
        {l:"J", p1:"Cuello largo", r1:"jirafa", p2:"Juguete que sube y baja", r2:"juguete"},
        {l:"L", p1:"Líquido blanco", r1:"leche", p2:"Satélite de la Tierra", r2:"luna"},
        {l:"M", p1:"Fruta roja/verde", r1:"manzana", p2:"Día después del lunes", r2:"martes"},
        {l:"N", p1:"Fruta cítrica", r1:"naranja", p2:"Opuesto de blanco", r2:"negro"},
        {l:"Ñ", p1:"Niño pequeño", r1:"niño", p2:"Ave parecida al avestruz", r2:"ñandu"},
        {l:"O", p1:"Da lana", r1:"oveja", p2:"Órgano para escuchar", r2:"oido"},
        {l:"P", p1:"Teclas blancas/negras", r1:"piano", p2:"Animal que ladra", r2:"perro"},
        {l:"Q", p1:"Leche cuajada", r1:"queso", p2:"Número 15", r2:"quince"},
        {l:"R", p1:"Pequeño roedor", r1:"raton", p2:"Color de la sangre", r2:"rojo"},
        {l:"S", p1:"Astro rey", r1:"sol", p2:"Lugar para sentarse", r2:"silla"},
        {l:"T", p1:"Hablar a distancia", r1:"telefono", p2:"Animal rayado", r2:"tigre"},
        {l:"U", p1:"Fruta del vino", r1:"uva", p2:"Número 1", r2:"uno"},
        {l:"V", p1:"Vive al lado", r1:"vecino", p2:"Color de la hierba", r2:"verde"},
        {l:"X", p1:"Instrumento musical", r1:"xilofono", p2:"Prueba médica", r2:"rayos x"},
        {l:"Y", p1:"Barco de lujo", r1:"yate", p2:"Parte del huevo", r2:"yema"},
        {l:"Z", p1:"Calzado", r1:"zapato", p2:"Animal con rayas blancas y negras", r2:"cebra"}
    ];

    /* VARIABLES DE ESTADO */
    let nombre = "";
    let modo = ""; 
    let peer = null; 
    let conn = null;
    let turnoActual = 1; 
    let miRol = 1; 
    let isAdmin = false;

    let estado = {
        j1: { pos: 0, aciertos: new Array(25).fill(0), nombre: "" },
        j2: { pos: 0, aciertos: new Array(25).fill(0), nombre: "" }
    };

    /* FUNCIONES DE NAVEGACIÓN */
    function ocultarTodo() {
        document.querySelectorAll('.pantalla').forEach(p => p.classList.add('oculto'));
        document.getElementById('tablero-juego').style.display = 'none';
    }

    function irAModos() {
        nombre = document.getElementById('input-nombre').value.trim();
        if(!nombre) return alert("Pon un nombre");
        estado.j1.nombre = nombre;
        document.getElementById('saludo-titulo').innerText = "HOLA, " + nombre.toUpperCase();
        ocultarTodo();
        document.getElementById('pantalla-modos').classList.remove('oculto');
        actualizarAdmin();
    }

    function volverAModos() { ocultarTodo(); document.getElementById('pantalla-modos').classList.remove('oculto'); }
    function irAOnline() { ocultarTodo(); document.getElementById('pantalla-online-opciones').classList.remove('oculto'); }
    function volverAOnline() { ocultarTodo(); document.getElementById('pantalla-online-opciones').classList.remove('oculto'); }

    /* LÓGICA DE ADMIN */
    function verificarAdmin() {
        const cod = document.getElementById('input-admin').value;
        if(cod === "Pablo23sek") {
            isAdmin = true;
            document.getElementById('panel-admin').style.display = 'block';
            alert("¡Modo Superadmin Activado!");
            actualizarAdmin();
        } else {
            alert("Código incorrecto");
        }
    }

    function actualizarAdmin() {
        if(!isAdmin) return;
        
        let conteo = 0;
        let listaHTML = "";

        // Jugador 1 (Host o Solo)
        if(estado.j1.nombre) {
            conteo++;
            listaHTML += `<div class="jugador-item">1. ${estado.j1.nombre} (HOST)</div>`;
        }

        // Jugador 2 (Guest)
        if(modo === 'online' && estado.j2.nombre) {
            conteo++;
            listaHTML += `<div class="jugador-item">2. ${estado.j2.nombre} (GUEST)</div>`;
        } else if (modo === 'online') {
            listaHTML += `<div class="jugador-item" style="color:#777">2. Esperando...</div>`;
        }

        document.getElementById('contador-jugadores').innerText = conteo;
        document.getElementById('admin-lista').innerHTML = listaHTML;
    }

    /* LÓGICA DE JUEGO */
    function modoSolo() {
        modo = 'solo'; miRol = 1; turnoActual = 1;
        document.getElementById('jugador-rival').classList.add('oculto');
        iniciarJuegoUI();
    }

    function pantallaGenerar() {
        modo = 'online'; miRol = 1; estado.j1.nombre = nombre;
        ocultarTodo(); document.getElementById('pantalla-host').classList.remove('oculto');
        const idSala = Math.floor(100000 + Math.random() * 900000);
        document.getElementById('codigo-mostrado').innerText = idSala;
        
        peer = new Peer(idSala.toString());
        peer.on('connection', (c) => {
            conn = c;
            document.getElementById('estado-host').innerText = "Conectando...";
            setupConexion();
        });
        actualizarAdmin();
    }

    function pantallaUnirse() {
        modo = 'online'; miRol = 2; estado.j2.nombre = nombre;
        ocultarTodo(); document.getElementById('pantalla-guest').classList.remove('oculto');
        actualizarAdmin();
    }

    function conectarHost() {
        const codigo = document.getElementById('input-codigo').value;
        if(codigo.length !== 6) return alert("Código de 6 cifras");
        document.getElementById('estado-guest').innerText = "Buscando...";
        peer = new Peer();
        peer.on('open', () => {
            conn = peer.connect(codigo);
            conn.on('open', () => {
                setupConexion();
                conn.send({ tipo: 'SALUDO', nombre: nombre });
            });
            peer.on('error', () => alert("Error de conexión"));
        });
    }

    function setupConexion() {
        conn.on('data', (data) => {
            if(data.tipo === 'SALUDO' && miRol === 1) {
                estado.j2.nombre = data.nombre;
                actualizarAdmin();
                enviarEstado('START');
                iniciarJuegoUI();
            }
            if(data.tipo === 'START') { estado = data.estado; iniciarJuegoUI(); }
            if(data.tipo === 'UPDATE') { estado = data.estado; turnoActual = data.turno; actualizarTablero(); }
        });
    }

    function enviarEstado(tipo) {
        if(conn) conn.send({ tipo: tipo, estado: estado, turno: turnoActual });
    }

    function iniciarJuegoUI() {
        ocultarTodo();
        document.getElementById('tablero-juego').style.display = 'block';
        document.getElementById('mi-nick').innerText = (miRol === 1) ? estado.j1.nombre : estado.j2.nombre;
        document.getElementById('rival-nick').innerText = (miRol === 1) ? estado.j2.nombre : estado.j1.nombre;
        
        if(modo === 'online') document.getElementById('jugador-rival').classList.remove('oculto');
        
        crearRoscoHTML('rosco-yo', 260);
        crearRoscoHTML('rosco-rival', 80);
        actualizarTablero();
        actualizarAdmin();
    }

    function crearRoscoHTML(id, radio) {
        const cont = document.getElementById(id);
        cont.innerHTML = "";
        banco.forEach((obj, i) => {
            let div = document.createElement('div');
            div.innerText = obj.l;
            div.className = 'letra';
            div.id = `${id}-${i}`;
            
            let ang = (i * 360 / 25) - 90;
            let rad = ang * (Math.PI / 180);
            let x = Math.cos(rad) * radio;
            let y = Math.sin(rad) * radio;
            
            div.style.left = `calc(50% + ${x}px - 19px)`; 
            div.style.top = `calc(50% + ${y}px - 19px)`;
            cont.appendChild(div);
        });
    }

    function actualizarTablero() {
        let misDatos = (miRol === 1) ? estado.j1 : estado.j2;
        let rivalDatos = (miRol === 1) ? estado.j2 : estado.j1;

        pintarRosco('rosco-yo', misDatos);
        pintarRosco('rosco-rival', rivalDatos);

        if(turnoActual === miRol) {
            let obj = banco[misDatos.pos];
            let preguntaTexto = (miRol === 1) ? obj.p1 : obj.p2; 
            
            document.getElementById('pregunta-texto').innerText = `CON LA ${obj.l}: ${preguntaTexto}`;
            document.getElementById('respuesta-input').disabled = false;
            document.getElementById('respuesta-input').focus();
            document.getElementById('jugador-yo').style.opacity = "1";
            document.getElementById('jugador-yo').style.borderColor = "var(--oro)";
            if(modo==='online') document.getElementById('jugador-rival').style.opacity = "0.5";
        } else {
            document.getElementById('pregunta-texto').innerText = "ESPERANDO AL RIVAL...";
            document.getElementById('respuesta-input').disabled = true;
            document.getElementById('jugador-yo').style.opacity = "0.7";
            document.getElementById('jugador-yo').style.borderColor = "#555";
            if(modo==='online') {
                document.getElementById('jugador-rival').style.opacity = "1";
                document.getElementById('jugador-rival').style.borderColor = "var(--oro)";
            }
        }
    }

    function pintarRosco(prefijo, datos) {
        for(let i=0; i<25; i++) {
            let el = document.getElementById(`${prefijo}-${i}`);
            el.className = 'letra';
            if(datos.aciertos[i] === 1) el.classList.add('bien');
            if(datos.aciertos[i] === 2) el.classList.add('mal');
            if(i === datos.pos) el.classList.add('actual');
        }
    }

    function enviarRespuesta() {
        if(turnoActual !== miRol) return;
        let misDatos = (miRol === 1) ? estado.j1 : estado.j2;
        let input = document.getElementById('respuesta-input');
        let respUser = input.value.toLowerCase().trim()
                                .normalize("NFD").replace(/[\u0300-\u036f]/g, ""); 
        
        let obj = banco[misDatos.pos];
        let respCorrecta = (miRol === 1) ? obj.r1 : obj.r2; 

        if(respUser === respCorrecta) {
            misDatos.aciertos[misDatos.pos] = 1;
        } else {
            misDatos.aciertos[misDatos.pos] = 2;
            if(modo !== 'solo') turnoActual = (turnoActual === 1) ? 2 : 1;
        }
        misDatos.pos = (misDatos.pos + 1) % 25;
        input.value = "";
        
        if(modo === 'online') enviarEstado('UPDATE');
        actualizarTablero();
    }

    function pasarPalabra() {
        if(turnoActual !== miRol) return;
        let misDatos = (miRol === 1) ? estado.j1 : estado.j2;
        misDatos.pos = (misDatos.pos + 1) % 25;
        if(modo !== 'solo') turnoActual = (turnoActual === 1) ? 2 : 1;
        
        document.getElementById('respuesta-input').value = "";
        if(modo === 'online') enviarEstado('UPDATE');
        actualizarTablero();
    }

    document.getElementById('respuesta-input').addEventListener('keypress', (e) => {
        if(e.key === 'Enter') enviarRespuesta();
    });

</script>
</body>
</html>
