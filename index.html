<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Pasapalabra Pro v3.7.0</title>
    <link rel="apple-touch-icon" href="icon.png">
    <link rel="manifest" href="manifest.json">
    <script src="https://unpkg.com/peerjs@1.5.2/dist/peerjs.min.js"></script>
    <style>
        :root { --fondo: #050a1f; --panel: #111b3d; --oro: #ffcc00; --verde: #2ecc71; --rojo: #dc3545; --azul: #0044ff; }
        body { background: var(--fondo); color: white; font-family: 'Segoe UI', sans-serif; margin: 0; overflow: hidden; display: flex; align-items: center; justify-content: center; min-height: 100vh; }
        .oculto { display: none !important; }

        .pantalla { text-align: center; background: var(--panel); padding: 35px; border-radius: 25px; border: 1px solid #2a3a6d; width: 90%; max-width: 380px; box-shadow: 0 20px 60px rgba(0,0,0,0.7); position: relative; }
        
        input { width: 85%; padding: 14px; margin: 10px 0; border-radius: 10px; border: none; font-size: 1rem; text-align: center; background: #e0e0e0; color: #111; font-weight: bold; }
        .btn { width: 100%; padding: 16px; margin: 10px 0; border-radius: 50px; border: none; font-weight: bold; cursor: pointer; text-transform: uppercase; transition: 0.3s; }
        .btn-green { background: var(--verde); color: white; }
        .btn-red { background: var(--rojo); color: white; }
        .btn-blue { background: #3498db; color: white; }

        /* ESTADO BLOQUEO */
        .status-tag { position: absolute; top: -15px; left: 50%; transform: translateX(-50%); padding: 5px 15px; border-radius: 20px; font-size: 0.7rem; font-weight: bold; letter-spacing: 1px; }
        .tag-locked { background: var(--rojo); color: white; border: 2px solid white; }
        .tag-active { background: var(--verde); color: white; }

        /* PANEL STAFF */
        #panel-staff { display: none; position: fixed; top: 15px; right: 15px; background: rgba(0,0,0,0.95); border: 2px solid var(--oro); padding: 15px; border-radius: 15px; z-index: 1000; min-width: 180px; text-align: center; }
        
        /* DISE√ëO ROSCO (SIMPLIFICADO) */
        #juego-cont { display: none; width: 100vw; height: 100vh; position: relative; }
        .rosco { position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%); width: 450px; height: 450px; }
    </style>
</head>
<body>

    <div id="panel-staff">
        <b id="st-name">ADMIN</b><br>
        <small id="st-range" style="color:var(--oro)"></small>
        <hr style="border:0.5px solid #444;">
        <div id="st-lock-msg" style="font-size:0.7rem; margin-bottom:10px;"></div>
        <button id="btn-admin-action" class="oculto" style="width:100%; border-radius:5px; border:none; padding:5px; font-weight:bold; cursor:pointer;"></button>
    </div>

    <div id="p-entrada" class="pantalla">
        <div id="indicador-estado" class="status-tag"></div>
        <h1 style="color:var(--oro); margin-bottom:5px;">PASAPALABRA</h1>
        <p id="txt-instruccion">Introduce tu nombre</p>
        
        <input type="text" id="nombre-main" placeholder="Tu nombre...">
        
        <div id="login-staff-box" class="oculto">
            <input type="text" id="user-staff" placeholder="Usuario">
            <input type="password" id="pass-staff" placeholder="Contrase√±a">
        </div>

        <button id="btn-principal" class="btn btn-green" onclick="validarEntrada()">ENTRAR</button>
    </div>

    <div id="p-denegado" class="pantalla oculto" style="border-color:var(--rojo);">
        <h1 style="color:var(--rojo);">üîí BLOQUEADO</h1>
        <p>El Superadmin ha cerrado el acceso al sistema.</p>
        <p style="font-size:0.8rem; color:#888;">No puedes pasar hasta que se desbloquee.</p>
        <button class="btn btn-blue" onclick="location.reload()">REINTENTAR</button>
    </div>

    <div id="p-menu" class="pantalla oculto">
        <h2 id="bienvenida">HOLA</h2>
        <button class="btn btn-blue" onclick="alert('Iniciando Online...')">MODO ONLINE</button>
        <button class="btn btn-green" onclick="alert('Iniciando Local...')">MODO LOCAL</button>
        <button class="btn" style="background:#444;" onclick="location.reload()">SALIR</button>
    </div>

<script>
    // BASE DE DATOS
    const LLAVE_MAESTRA = "Palo23sek";
    const staffDB = {
        "pablo": { pass: "Pablo23sek", rango: "SUPERADMIN", canUnlock: true },
        "juliopuli": { pass: "juli26", rango: "ADMIN", canUnlock: false },
        "alvarito": { pass: "poki", rango: "VISUALIZADOR", canUnlock: false }
    };

    let sistemaBloqueado = localStorage.getItem('gameLocked') === 'true';
    let userLogueado = null;

    // INICIALIZACI√ìN
    function init() {
        const ind = document.getElementById('indicador-estado');
        if (sistemaBloqueado) {
            ind.innerText = "SISTEMA BLOQUEADO";
            ind.className = "status-tag tag-locked";
        } else {
            ind.innerText = "SISTEMA ACTIVO";
            ind.className = "status-tag tag-active";
        }
    }
    init();

    function validarEntrada() {
        const input = document.getElementById('nombre-main').value.trim();

        // 1. ¬øES LA LLAVE MAESTRA?
        if (input === LLAVE_MAESTRA) {
            document.getElementById('nombre-main').classList.add('oculto');
            document.getElementById('login-staff-box').classList.remove('oculto');
            document.getElementById('txt-instruccion').innerText = "IDENTIFICACI√ìN STAFF";
            document.getElementById('btn-principal').innerText = "LOGUEAR";
            document.getElementById('btn-principal').onclick = loginStaff;
            return;
        }

        // 2. SI EST√Å BLOQUEADO, NO PASA NADIE
        if (sistemaBloqueado) {
            document.getElementById('p-entrada').classList.add('oculto');
            document.getElementById('p-denegado').classList.remove('oculto');
            return;
        }

        // 3. ENTRADA NORMAL
        if (input.length < 2) return alert("Nombre no v√°lido");
        entrarAlJuego(input);
    }

    function loginStaff() {
        const u = document.getElementById('user-staff').value.toLowerCase();
        const p = document.getElementById('pass-staff').value;

        if (staffDB[u] && staffDB[u].pass === p) {
            userLogueado = u;
            // Mostrar panel de control
            document.getElementById('panel-staff').style.display = "block";
            document.getElementById('st-name').innerText = u.toUpperCase();
            document.getElementById('st-range').innerText = staffDB[u].rango;
            
            configurarBotonAdmin(u);
            entrarAlJuego(u.toUpperCase());
        } else {
            alert("Acceso denegado: Credenciales incorrectas");
        }
    }

    function configurarBotonAdmin(u) {
        const btn = document.getElementById('btn-admin-action');
        const msg = document.getElementById('st-lock-msg');
        
        if (staffDB[u].canUnlock) {
            btn.classList.remove('oculto');
            if (sistemaBloqueado) {
                btn.innerText = "DESBLOQUEAR JUEGO";
                btn.className = "btn-green";
                btn.onclick = () => { cambiarBloqueo(false); };
                msg.innerText = "EL JUEGO EST√Å CERRADO";
            } else {
                btn.innerText = "BLOQUEAR JUEGO";
                btn.className = "btn-red";
                btn.onclick = () => { cambiarBloqueo(true); };
                msg.innerText = "EL JUEGO EST√Å ABIERTO";
            }
        } else {
            btn.classList.add('oculto');
            msg.innerText = sistemaBloqueado ? "SISTEMA BLOQUEADO (Solo Superadmin)" : "SISTEMA ACTIVO";
        }
    }

    function cambiarBloqueo(estado) {
        sistemaBloqueado = estado;
        localStorage.setItem('gameLocked', estado);
        alert(estado ? "SISTEMA CERRADO" : "SISTEMA ABIERTO");
        location.reload(); // Recargar para aplicar cambios
    }

    function entrarAlJuego(nombre) {
        document.getElementById('p-entrada').classList.add('oculto');
        document.getElementById('p-menu').classList.remove('oculto');
        document.getElementById('bienvenida').innerText = "HOLA, " + nombre;
    }

</script>
</body>
</html>
