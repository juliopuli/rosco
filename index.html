<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <title>Pasapalabra Pro</title>
    <style>
        body { 
            background-color: #050a1f; color: white; font-family: 'Segoe UI', Arial, sans-serif; 
            display: flex; flex-direction: column; align-items: center; justify-content: center; 
            min-height: 100vh; margin: 0; overflow: hidden;
        }
        
        /* --- ESTILOS GENERALES --- */
        .titulo { font-size: 2.5rem; color: #ffcc00; text-shadow: 0 0 15px #ffcc00; margin-bottom: 20px; z-index: 10; }
        .pantalla { 
            text-align: center; background: #111b3d; padding: 40px; 
            border-radius: 20px; border: 1px solid #2a3a6d; width: 400px; 
            box-shadow: 0 10px 40px rgba(0,0,0,0.6); position: relative; z-index: 20;
        }
        .btn { 
            display: block; width: 100%; padding: 15px; margin: 15px 0; 
            border-radius: 50px; border: none; font-weight: bold; cursor: pointer; 
            font-size: 1.1rem; text-transform: uppercase; transition: transform 0.2s;
        }
        .btn:active { transform: scale(0.95); }
        .btn-green { background: #2ecc71; color: white; }
        .btn-blue { background: #3498db; color: white; }
        .btn-yellow { background: #f1c40f; color: black; }
        
        input { 
            width: 80%; padding: 15px; border-radius: 10px; border: 2px solid #3498db; 
            background: #0a142f; color: white; font-size: 1.2rem; text-align: center; margin-bottom: 10px;
        }

        .oculto { display: none !important; }

        /* --- SALA DE JUEGO (LAYOUT) --- */
        #juego { 
            display: none; width: 100%; height: 100vh; position: relative; 
        }
        
        #header-juego {
            position: absolute; top: 20px; width: 100%; text-align: center;
        }
        .sala-info { background: #ffcc00; color: black; padding: 5px 20px; border-radius: 20px; font-weight: bold; }

        /* --- CONTENEDORES DE JUGADORES (ANIMACIÓN) --- */
        .contenedor-jugador {
            position: absolute;
            transition: all 0.8s cubic-bezier(0.68, -0.55, 0.27, 1.55); /* Animación rebote suave */
            background: rgba(17, 27, 61, 0.9);
            border-radius: 50%;
            display: flex; flex-direction: column; align-items: center; justify-content: center;
        }

        /* ESTADO: TURNO ACTIVO (Grande y Centrado) */
        .turno-activo {
            width: 500px; height: 500px;
            top: 50%; left: 50%;
            transform: translate(-50%, -40%); /* Centrado */
            z-index: 10;
            border: 2px solid #2ecc71;
            box-shadow: 0 0 50px rgba(46, 204, 113, 0.2);
        }
        .turno-activo .panel-controles { display: block; opacity: 1; transition: opacity 0.5s 0.5s; }

        /* ESTADO: TURNO INACTIVO (Pequeño y Arriba) */
        .turno-inactivo {
            width: 150px; height: 150px;
            top: 100px;
            z-index: 1;
            border: 2px solid #555;
            opacity: 0.6;
            transform: scale(0.8);
        }
        /* Posiciones específicas para el inactivo */
        #bloque-j1.turno-inactivo { left: 10%; }
        #bloque-j2.turno-inactivo { right: 10%; }
        
        .turno-inactivo .panel-controles { display: none; opacity: 0; }
        .turno-inactivo .nombre-jugador { font-size: 0.8rem; margin-top: -30px; }
        .turno-inactivo .rosco-visual .letra { width: 15px; height: 15px; font-size: 8px; border-width: 1px; }

        /* --- ROSCO VISUAL --- */
        .rosco-visual { position: relative; transition: all 0.8s; }
        
        .turno-activo .rosco-visual { width: 380px; height: 380px; }
        .turno-inactivo .rosco-visual { width: 120px; height: 120px; margin-top: 10px; }

        .letra { 
            position: absolute; background: #0044ff; border-radius: 50%; 
            display: flex; justify-content: center; align-items: center; 
            color: white; font-weight: bold; transition: all 0.3s;
        }
        
        .turno-activo .letra { width: 36px; height: 36px; font-size: 16px; border: 2px solid white; }
        
        .letra.activa { background: #ffcc00; color: black; box-shadow: 0 0 15px #ffcc00; transform: scale(1.2); }
        .letra.correcta { background: #28a745; }
        .letra.incorrecta { background: #dc3545; }

        /* --- PANELES DE CONTROL --- */
        .panel-controles {
            position: absolute; bottom: -120px; width: 100%; text-align: center;
            background: #111b3d; padding: 15px; border-radius: 15px; border: 1px solid #2a3a6d;
        }
        .pregunta-texto { min-height: 40px; margin-bottom: 10px; font-size: 1.1rem; }
        .btns-row { display: flex; gap: 10px; justify-content: center; }
        .nombre-jugador { position: absolute; top: -40px; width: 100%; text-align: center; font-weight: bold; font-size: 1.5rem; color: #fff; }

    </style>
</head>
<body>

    <div id="pantalla-nombre" class="pantalla">
        <h2 style="color:#ffcc00">BIENVENIDO</h2>
        <p>Antes de empezar, dinos quién eres:</p>
        <input type="text" id="input-nombre" placeholder="Tu Nombre">
        <button class="btn btn-green" onclick="guardarNombre()">CONTINUAR</button>
    </div>

    <div id="pantalla-menu" class="pantalla oculto">
        <h1 class="titulo">PASAPALABRA</h1>
        <h3 id="saludo-usuario" style="color:#3498db"></h3>
        <button class="btn btn-green" onclick="iniciarLocal()">JUGAR LOCAL</button>
        <button class="btn btn-blue" onclick="mostrarOnline()">JUGAR ONLINE</button>
    </div>

    <div id="pantalla-online" class="pantalla oculto">
        <h3>MODO ONLINE</h3>
        <button class="btn btn-blue" onclick="generarSala()">GENERAR CÓDIGO</button>
        <p>— O —</p>
        <input type="text" id="codigo-input" placeholder="Código de Sala">
        <button class="btn btn-green" onclick="unirseSala()">UNIRSE</button>
        <button class="btn" onclick="volverMenu()">VOLVER</button>
    </div>

    <div id="pantalla-lobby" class="pantalla oculto">
        <h2>TU SALA:</h2>
        <h1 id="codigo-grande" style="font-size: 3rem; color: #ffcc00; letter-spacing: 5px;">---</h1>
        <p>Comparte este código con tu rival.</p>
        <button class="btn btn-green" onclick="empezarJuego()">EMPEZAR YA</button>
    </div>

    <div id="juego">
        <div id="header-juego">
            <span id="info-sala" class="sala-info">LOCAL</span>
            <h1 class="titulo" style="font-size: 1.5rem; margin: 10px 0;">PASAPALABRA</h1>
        </div>

        <div id="bloque-j1" class="contenedor-jugador turno-activo">
            <div class="nombre-jugador" id="name-j1">JUGADOR 1</div>
            <div id="rosco1" class="rosco-visual"></div>
            
            <div class="panel-controles">
                <div id="preg1" class="pregunta-texto">Cargando...</div>
                <input type="text" id="resp1" placeholder="Respuesta..." autocomplete="off">
                <div class="btns-row">
                    <button class="btn btn-green" style="width: auto; padding: 10px 30px;" onclick="validar(1)">ENVIAR</button>
                    <button class="btn btn-yellow" style="width: auto; padding: 10px 30px;" onclick="pasapalabra(1)">PASO</button>
                </div>
            </div>
        </div>

        <div id="bloque-j2" class="contenedor-jugador turno-inactivo">
            <div class="nombre-jugador" id="name-j2">RIVAL</div>
            <div id="rosco2" class="rosco-visual"></div>

            <div class="panel-controles">
                <div id="preg2" class="pregunta-texto">Cargando...</div>
                <input type="text" id="resp2" placeholder="Respuesta..." autocomplete="off">
                <div class="btns-row">
                    <button class="btn btn-green" style="width: auto; padding: 10px 30px;" onclick="validar(2)">ENVIAR</button>
                    <button class="btn btn-yellow" style="width: auto; padding: 10px 30px;" onclick="pasapalabra(2)">PASO</button>
                </div>
            </div>
        </div>
    </div>

    <script>
        /* --- DATOS Y VARIABLES --- */
        let miNombre = "Jugador 1";
        let turnoActual = 1; // 1 o 2

        const pool = {
            "A": [{p:"Relativo a las abejas", r:"apícola"}, {p:"Árbol de bellotas", r:"alcornoque"}],
            "B": [{p:"Mide dirección viento", r:"veleta"}, {p:"Embarcación vela", r:"balandra"}],
            "C": [{p:"Cabeza de estado", r:"capital"}, {p:"Vehículo de carga", r:"camión"}],
            "D": [{p:"Animal marino", r:"delfín"}, {p:"Número 10", r:"diez"}],
            "E": [{p:"Cría de elefantes", r:"elefantería"}, {p:"Relativo a estrellas", r:"estelar"}],
            "F": [{p:"Luz guía barcos", r:"faro"}, {p:"Vigor, robustez", r:"fuerza"}],
            "G": [{p:"Ave de corral", r:"gallina"}, {p:"Felino doméstico", r:"gato"}],
            "H": [{p:"Agua sólida", r:"hielo"}, {p:"Hace reír", r:"humorista"}],
            "I": [{p:"Tierra rodeada agua", r:"isla"}, {p:"Edificio religioso", r:"iglesia"}],
            "J": [{p:"Cuello largo", r:"jirafa"}, {p:"Aplica justicia", r:"juez"}],
            "L": [{p:"Líquido blanco", r:"leche"}, {p:"Tienda de libros", r:"librería"}],
            "M": [{p:"Fruta roja/verde", r:"manzana"}, {p:"Planeta rojo", r:"marte"}],
            "N": [{p:"Cítrico naranja", r:"naranja"}, {p:"Barco espacial", r:"nave"}],
            "Ñ": [{p:"Pocos años", r:"niño"}, {p:"Madera para fuego", r:"leña"}],
            "O": [{p:"Da lana", r:"oveja"}, {p:"Ave corredora", r:"avestruz"}],
            "P": [{p:"Instrumento teclas", r:"piano"}, {p:"Caballo joven", r:"potro"}],
            "Q": [{p:"Derivado lácteo", r:"queso"}, {p:"Pared delgada", r:"tabique"}],
            "R": [{p:"Pequeño roedor", r:"ratón"}, {p:"Marca la hora", r:"reloj"}],
            "S": [{p:"Estrella sistema", r:"sol"}, {p:"Asiento con respaldo", r:"silla"}],
            "T": [{p:"Hablar a distancia", r:"teléfono"}, {p:"Persona que trabaja", r:"trabajador"}],
            "U": [{p:"Fruta del vino", r:"uva"}, {p:"Un solo color", r:"unicolor"}],
            "V": [{p:"Habita al lado", r:"vecino"}, {p:"Estación cálida", r:"verano"}],
            "X": [{p:"Examen tejido", r:"biopsia"}, {p:"Instrumento música", r:"xilófono"}],
            "Y": [{p:"Barco de lujo", r:"yate"}, {p:"Parte del huevo", r:"yema"}],
            "Z": [{p:"Calzado", r:"zapato"}, {p:"Animal astuto", r:"zorro"}]
        };

        const letras = Object.keys(pool);
        let j1 = { ind: 0, pregs: [] }, j2 = { ind: 0, pregs: [] };

        /* --- FUNCIONES DE NAVEGACIÓN --- */
        function guardarNombre() {
            const val = document.getElementById('input-nombre').value;
            if(val.trim() === "") return alert("Pon un nombre por favor.");
            miNombre = val;
            document.getElementById('name-j1').innerText = miNombre;
            document.getElementById('saludo-usuario').innerText = "HOLA, " + miNombre.toUpperCase();
            cambiarPantalla('pantalla-menu');
        }

        function cambiarPantalla(id) {
            document.querySelectorAll('.pantalla').forEach(p => p.classList.add('oculto'));
            document.getElementById(id).classList.remove('oculto');
        }

        function mostrarOnline() { cambiarPantalla('pantalla-online'); }
        function volverMenu() { cambiarPantalla('pantalla-menu'); }

        function iniciarLocal() {
            prepararJuego("MODO LOCAL");
        }

        function generarSala() {
            const cod = Math.floor(100000 + Math.random() * 900000);
            document.getElementById('codigo-grande').innerText = cod;
            document.getElementById('info-sala').innerText = "SALA: " + cod;
            cambiarPantalla('pantalla-lobby');
        }

        function unirseSala() {
            const cod = document.getElementById('codigo-input').value;
            if(cod.length < 4) return alert("Código no válido");
            document.getElementById('info-sala').innerText = "SALA: " + cod;
            empezarJuego();
        }

        function empezarJuego() {
            prepararJuego(document.getElementById('info-sala').innerText);
        }

        /* --- LÓGICA DEL JUEGO --- */
        function prepararJuego(textoInfo) {
            document.querySelectorAll('.pantalla').forEach(p => p.classList.add('oculto'));
            document.getElementById('juego').style.display = 'block';
            document.getElementById('info-sala').innerText = textoInfo;

            // Cargar preguntas
            j1.pregs = letras.map(l => ({l:l, ...pool[l][Math.floor(Math.random()*pool[l].length)]}));
            j2.pregs = letras.map(l => ({l:l, ...pool[l][Math.floor(Math.random()*pool[l].length)]}));

            dibujarRosco(1); dibujarRosco(2);
            actualizarPregunta(1); actualizarPregunta(2);
            
            // Inicia Turno 1
            turnoActual = 1;
            aplicarTurnoVisual();
        }

        function aplicarTurnoVisual() {
            const b1 = document.getElementById('bloque-j1');
            const b2 = document.getElementById('bloque-j2');
            
            if(turnoActual === 1) {
                // J1 Grande, J2 Pequeño
                b1.className = "contenedor-jugador turno-activo";
                b2.className = "contenedor-jugador turno-inactivo";
                document.getElementById('resp1').focus();
            } else {
                // J2 Grande, J1 Pequeño
                b1.className = "contenedor-jugador turno-inactivo";
                b2.className = "contenedor-jugador turno-activo";
                document.getElementById('resp2').focus();
            }
        }

        function dibujarRosco(n) {
            const con = document.getElementById('rosco'+n);
            con.innerHTML = "";
            letras.forEach((l, i) => {
                const div = document.createElement('div');
                div.className = 'letra';
                div.id = `L${n}-${i}`;
                div.innerText = l;
                
                // Cálculo para ponerlas en círculo
                const ang = (i * 360 / letras.length) - 90;
                // Radio: si es visual grande o pequeño se ajusta por CSS, aquí ponemos posición relativa %
                // Usamos posicionamiento relativo al centro (50%)
                const rad = 170; // radio base
                const x = rad * Math.cos(ang * Math.PI / 180);
                const y = rad * Math.sin(ang * Math.PI / 180);
                
                // Truco: usamos left/top desde el 50%
                div.style.left = `calc(50% + ${x}px - 18px)`;
                div.style.top = `calc(50% + ${y}px - 18px)`;
                
                con.appendChild(div);
            });
        }

        function actualizarPregunta(n) {
            const p = (n===1) ? j1 : j2;
            const item = p.pregs[p.ind];
            document.getElementById('preg'+n).innerHTML = `<b>CON LA ${item.l}:</b> ${item.p}`;
            // Marcar letra activa
            document.querySelectorAll(`#rosco${n} .letra`).forEach(l => l.classList.remove('activa'));
            document.getElementById(`L${n}-${p.ind}`).classList.add('activa');
        }

        function validar(n) {
            const p = (n===1) ? j1 : j2;
            const input = document.getElementById('resp'+n);
            const val = input.value.toLowerCase().trim();
            const cor = p.pregs[p.ind].r.toLowerCase();
            const el = document.getElementById(`L${n}-${p.ind}`);

            if(val === cor) {
                el.classList.add('correcta');
                // Si acierta, sigue jugando (no cambia turno)
                p.ind = (p.ind + 1) % letras.length;
                actualizarPregunta(n);
                input.value = "";
                input.focus();
            } else {
                el.classList.add('incorrecta');
                // Si falla, cambia turno
                input.value = "";
                p.ind = (p.ind + 1) % letras.length;
                actualizarPregunta(n);
                cambiarTurno();
            }
        }

        function pasapalabra(n) {
            const p = (n===1) ? j1 : j2;
            // Solo avanza letra y cambia turno
            p.ind = (p.ind + 1) % letras.length;
            actualizarPregunta(n);
            cambiarTurno();
        }

        function cambiarTurno() {
            turnoActual = (turnoActual === 1) ? 2 : 1;
            aplicarTurnoVisual();
        }

        // Tecla Enter
        document.getElementById('resp1').addEventListener('keyup', (e)=>{if(e.key==='Enter') validar(1)});
        document.getElementById('resp2').addEventListener('keyup', (e)=>{if(e.key==='Enter') validar(2)});

    </script>
</body>
</html>
