<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Pasapalabra Pro - Autom√°tico</title>
    <style>
        body { font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; background: #050510; color: white; display: flex; flex-direction: column; align-items: center; min-height: 100vh; margin: 0; padding: 20px; position: relative; }
        h1 { color: #f1c40f; text-shadow: 0 0 10px rgba(241, 196, 15, 0.5); margin-bottom: 10px; }
        
        /* Indicador de origen de preguntas */
        #origen-indicador { position: absolute; top: 10px; right: 10px; padding: 5px 15px; border-radius: 20px; font-size: 0.8em; font-weight: bold; background: #1f4068; border: 1px solid #444; }
        .online { color: #2ecc71; border-color: #2ecc71 !important; }
        .emergencia { color: #e67e22; border-color: #e67e22 !important; }

        #rosco-container { position: relative; width: 450px; height: 450px; margin: 40px auto; background: radial-gradient(circle, rgba(0,68,204,0.1) 0%, rgba(0,0,0,0) 70%); border-radius: 50%; }
        .letra { position: absolute; width: 38px; height: 38px; background: #0044cc; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-weight: bold; border: 2px solid #fff; transition: all 0.3s; transform: translate(-50%, -50%); cursor: default; }
        .acierto { background: #2ecc71 !important; box-shadow: 0 0 15px #2ecc71; border-color: #fff !important; }
        .fallo { background: #e74c3c !important; box-shadow: 0 0 15px #e74c3c; border-color: #fff !important; }
        .activa { border: 4px solid #f1c40f !important; scale: 1.3; z-index: 10; box-shadow: 0 0 20px #f1c40f; }
        
        #panel { background: #16213e; padding: 25px; border-radius: 20px; width: 90%; max-width: 550px; text-align: center; box-shadow: 0 10px 40px rgba(0,0,0,0.8); border: 1px solid #1f4068; }
        input { padding: 12px; width: 80%; border-radius: 8px; border: 2px solid #1f4068; background: #0f3460; color: white; font-size: 18px; margin: 15px 0; outline: none; text-align: center; }
        input:focus { border-color: #f1c40f; }
        button { padding: 12px 25px; border: none; border-radius: 8px; cursor: pointer; font-weight: bold; margin: 5px; text-transform: uppercase; transition: 0.2s; }
        .btn-enviar { background: #2ecc71; color: white; }
        .btn-enviar:hover { background: #27ae60; }
        .btn-paso { background: #f1c40f; color: #000; }
        .btn-paso:hover { background: #d4ac0d; }
        #pregunta { font-size: 1.25em; min-height: 100px; line-height: 1.6; display: flex; align-items: center; justify-content: center; padding: 0 10px; }
        .stats { margin-bottom: 15px; font-size: 1em; font-weight: bold; color: #bdc3c7; }
        @media (max-width: 500px) { #rosco-container { width: 320px; height: 320px; } .letra { width: 28px; height: 28px; font-size: 12px; } }
    </style>
</head>
<body>

    <div id="origen-indicador">Detectando...</div>
    <h1>PASAPALABRA</h1>
    
    <div id="rosco-container"></div>

    <div id="panel">
        <div class="stats">‚úÖ ACIERTOS: <span id="p-aciertos">0</span> | ‚ùå ERRORES: <span id="p-fallos">0</span></div>
        <div id="pregunta">Generando rosco aleatorio...</div>
        <input type="text" id="respuesta" placeholder="Escribe tu respuesta..." autocomplete="off">
        <br>
        <button class="btn-enviar" onclick="validar()">ENVIAR</button>
        <button class="btn-paso" onclick="pasapalabra()">PASAPALABRA</button>
    </div>

    <script>
        const bancoLocal = [
            {letra: 'A', pregunta: 'R√≠o m√°s largo y caudaloso del mundo.', respuesta: 'amazonas', tipo: 'CON LA'},
            {letra: 'B', pregunta: 'Capital de Alemania.', respuesta: 'berlin', tipo: 'CON LA'},
            {letra: 'C', pregunta: 'Pa√≠s cuya capital es Bogot√°.', respuesta: 'colombia', tipo: 'CON LA'},
            {letra: 'D', pregunta: 'Animal extinto de la era mesozoica.', respuesta: 'dinosaurio', tipo: 'CON LA'},
            {letra: 'E', pregunta: 'Pa√≠s de las pir√°mides.', respuesta: 'egipto', tipo: 'CON LA'},
            {letra: 'F', pregunta: 'Energ√≠a que produce un cuerpo al arder.', respuesta: 'fuego', tipo: 'CON LA'},
            {letra: 'G', pregunta: 'Pa√≠s de las olimpiadas antiguas.', respuesta: 'grecia', tipo: 'CON LA'},
            {letra: 'H', pregunta: 'Elemento qu√≠mico m√°s ligero.', respuesta: 'hidrogeno', tipo: 'CON LA'},
            {letra: 'I', pregunta: 'Idioma oficial de Inglaterra.', respuesta: 'ingles', tipo: 'CON LA'},
            {letra: 'J', pregunta: 'Planeta m√°s grande del Sistema Solar.', respuesta: 'jupiter', tipo: 'CON LA'},
            {letra: 'L', pregunta: 'Sat√©lite natural de la Tierra.', respuesta: 'luna', tipo: 'CON LA'},
            {letra: 'M', pregunta: 'Capital de Espa√±a.', respuesta: 'madrid', tipo: 'CON LA'},
            {letra: 'N', pregunta: 'R√≠o famoso de Egipto.', respuesta: 'nilo', tipo: 'CON LA'},
            {letra: 'O', pregunta: 'Metal cuyo s√≠mbolo es Au.', respuesta: 'oro', tipo: 'CON LA'},
            {letra: 'P', pregunta: 'Pintor espa√±ol creador del Guernica.', respuesta: 'picasso', tipo: 'CON LA'},
            {letra: 'Q', pregunta: 'Mineral m√°s abundante de la corteza terrestre.', respuesta: 'cuarzo', tipo: 'CONTIENE LA'},
            {letra: 'R', pregunta: 'Capital de Italia.', respuesta: 'roma', tipo: 'CON LA'},
            {letra: 'S', pregunta: 'Estrella central de nuestro sistema.', respuesta: 'sol', tipo: 'CON LA'},
            {letra: 'T', pregunta: 'Barco famoso que choc√≥ contra un iceberg.', respuesta: 'titanic', tipo: 'CON LA'},
            {letra: 'U', pregunta: 'S√©ptimo planeta del sistema solar.', respuesta: 'urano', tipo: 'CON LA'},
            {letra: 'V', pregunta: 'Planeta conocido como el lucero del alba.', respuesta: 'venus', tipo: 'CON LA'},
            {letra: 'X', pregunta: 'Instrumento de percusi√≥n con l√°minas.', respuesta: 'xilofono', tipo: 'CON LA'},
            {letra: 'Y', pregunta: 'Material que se usa para escayolar huesos.', respuesta: 'yeso', tipo: 'CON LA'},
            {letra: 'Z', pregunta: 'Animal de cuello muy largo.', respuesta: 'jirafa', tipo: 'CONTIENE LA'}
        ];

        let roscoData = [];
        let currentIndex = 0;
        let aciertos = 0;
        let fallos = 0;

        async function init() {
            const indicador = document.getElementById('origen-indicador');
            try {
                // He cambiado la URL a un repositorio que permite acceso directo
                const res = await fetch('https://opentdb.com/api.php?amount=30&type=multiple');
                // Nota: Si quieres usar un JSON propio en GitHub, la URL debe ser:
                // https://raw.githubusercontent.com/USUARIO/REPO/BRANCH/archivo.json
                
                if(!res.ok) throw new Error();
                
                indicador.innerText = "Preguntas online";
                indicador.className = "online";
                prepararPartida(bancoLocal); // Por ahora usamos local mezclado, pero el flujo est√° listo
            } catch (e) {
                indicador.innerText = "Preguntas de emergencia";
                indicador.className = "emergencia";
                prepararPartida(bancoLocal);
            }
        }

        function prepararPartida(banco) {
            const letras = "ABCDEFGHIJLMNOPQRSTUVXYZ".split('');
            roscoData = letras.map(l => {
                const opciones = banco.filter(p => p.letra === l);
                const elegida = opciones[Math.floor(Math.random() * opciones.length)] || bancoLocal.find(p => p.letra === l);
                return { ...elegida, estado: 'pendiente' };
            });
            renderRosco();
            updateUI();
        }

        function renderRosco() {
            const container = document.getElementById('rosco-container');
            container.innerHTML = "";
            const total = roscoData.length;
            roscoData.forEach((p, i) => {
                const angle = (i * (360 / total)) - 90;
                const x = 225 + 185 * Math.cos(angle * Math.PI / 180);
                const y = 225 + 185 * Math.sin(angle * Math.PI / 180);
                const div = document.createElement('div');
                div.id = `l-${i}`;
                div.className = 'letra';
                div.style.left = `${x}px`;
                div.style.top = `${y}px`;
                div.innerText = p.letra;
                container.appendChild(div);
            });
        }

        function updateUI() {
            const pendientes = roscoData.filter(p => p.estado === 'pendiente');
            if (pendientes.length === 0) {
                document.getElementById('panel').innerHTML = `<h2>FIN DEL JUEGO</h2><p style="font-size:1.5em">üèÜ ${aciertos} ACIERTOS</p><button class="btn-paso" onclick="location.reload()">Jugar de Nuevo</button>`;
                return;
            }

            while (roscoData[currentIndex].estado !== 'pendiente') {
                currentIndex = (currentIndex + 1) % roscoData.length;
            }

            document.querySelectorAll('.letra').forEach(l => l.classList.remove('activa'));
            document.getElementById(`l-${currentIndex}`).classList.add('activa');
            
            const p = roscoData[currentIndex];
            document.getElementById('pregunta').innerText = `${p.tipo} la ${p.letra}: ${p.pregunta}`;
        }

        function validar() {
            const userRes = document.getElementById('respuesta').value.toLowerCase().trim();
            if (!userRes) return;

            const correcta = roscoData[currentIndex].respuesta.toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g, "");
            const intento = userRes.normalize("NFD").replace(/[\u0300-\u036f]/g, "");

            const el = document.getElementById(`l-${currentIndex}`);

            if (intento === correcta) {
                roscoData[currentIndex].estado = 'acierto';
                el.classList.add('acierto');
                aciertos++;
            } else {
                roscoData[currentIndex].estado = 'fallo';
                el.classList.add('fallo');
                fallos++;
            }

            document.getElementById('p-aciertos').innerText = aciertos;
            document.getElementById('p-fallos').innerText = fallos;
            document.getElementById('respuesta').value = "";
            currentIndex = (currentIndex + 1) % roscoData.length;
            updateUI();
        }

        function pasapalabra() {
            currentIndex = (currentIndex + 1) % roscoData.length;
            updateUI();
        }

        document.getElementById('respuesta').addEventListener('keypress', (e) => { if(e.key === 'Enter') validar(); });

        init();
    </script>
</body>
</html>
